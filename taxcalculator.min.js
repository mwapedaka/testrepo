function calculateTax(b,a,c){function f(a,b){return a>b.above?(a-=b.above,{gross:b.above,net:a-b.rate/100*a}):{gross:a,net:a}}var d=0;c=c||0;if("number"!==typeof c)throw Error("Invalid value for 'allowableTaxFree' (number is required).");if("number"!==typeof b)throw Error("Invalid value for 'gross' (number is required).");if(!Array.isArray(a))throw Error("An array of taxBands is required");for(j=0;j<a.length;j++){if("object"!==typeof a[j])throw Error("Invalid value for 'gross' (number is required).");
if("number"!==typeof a[j].rate)throw Error("Invalid value for 'rate' (number is required).");if("number"!==typeof a[j].above)throw Error("Invalid value for 'above' (number is required).");}b-=c;a=a.sort(function(a,b){return b.above-a.above});for(i=0;i<a.length;i++){var e=f(b,a[i]);b=e.gross;d+=e.net}return d+b+c};
